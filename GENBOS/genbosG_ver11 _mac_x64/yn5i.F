       
        FUNCTION QB(X,T,B,N)
        DIMENSION B(30),T(30)
        LP=1
  18    IF(X-T(LP) < 0) THEN
        GOTO 10
        ELSE IF (X-T(LP) == 0) THEN
        GOTO 11
        ELSE IF (X-T(LP) > 0) THEN
        GOTO 12
        END IF
  10    IF(LP-1 < 0) THEN
        GOTO 13
        ELSE IF (LP-1 == 0) THEN
        GOTO 13
        ELSE IF (LP-1 > 0) THEN
        GOTO 14
        END IF

 13    QB=B(1)
        RETURN
  14    IF(LP-(N-1) < 0) THEN
        GOTO 17
        ELSE IF (LP-(N-1) == 0) THEN
        GOTO 16
        ELSE IF (LP-(N-1) > 0) THEN
        GOTO 16
        END IF

  16    PH1=B(N-2)
        PS1=T(N-2)
        PH2=B(N-1)
        PS2=T(N-1)
        PH3=B(N)
        PS3=T(N)
        GO TO 15
  11    QB=B(LP)
        RETURN
  12    LP=LP+1
        IF(LP-N < 0) THEN
        GOTO 18
        ELSE IF ((LP-N) == 0) THEN
        GOTO 19
        ELSE IF ((LP-N) > 0) THEN
        GOTO 19
        END IF

  19    QB=B(N)
        RETURN
  17    PH1=B(LP-1)
        PS1=T(LP-1)
        PH2=B(LP)
        PS2=T(LP)
        PH3=B(LP+1)
        PS3=T(LP+1)
        GO TO 15
  15    DEL=(PS2-PS3)*PS1**2+(PS3-PS1)*PS2**2+(PS1-PS2)*PS3**2
        DELA=PH1*(PS2-PS3)+PH2*(PS3-PS1)+PH3*(PS1-PS2)
        DELD=(PH2-PH3)*PS1**2+(PH3-PH1)*PS2**2+(PH1-PH2)*PS3**2
        DELC=(PS2*PH3-PS3*PH2)*PS1**2+(PS3*PH1-PS1*PH3)*PS2**2
     *  +(PS1*PH2-PS2*PH1)*PS3**2
        A=DELA/DEL
        D=DELD/DEL
        C=DELC/DEL
        QB=A*X**2+D*X+C
        RETURN
        END



        SUBROUTINE TC8
        COMMON/B/B1(30),B2(30),CTM(30)
        COMMON/TL/TL(30),NL
        COMMON/TE/TE(30),NE
        COMMON/BE/BE(30)
        DATA TL/
     *  0.020, 0.040, 0.050, 0.063, 0.083, 0.110, 0.137, 0.175, 0.226,
     *  0.288, 0.334, 0.425, 0.499, 0.538, 0.608, 0.664, 0.713, 0.771,
     *  0.830, 0.916, 1.011, 1.100, 1.144, 1.189, 1.279, 1.379, 1.572,
     *  2.203, 4.840, 7.115/
        DATA B1/
     *  1.13,  1.52,  1.67,  1.94,  2.45,  2.70,  3.00,  3.54,  4.14,
     *  4.46,  4.71,  5.99,  7.04,  7.58,  8.57,  9.37, 10.06, 10.87,
     * 11.12, 12.27, 13.55, 14.73, 15.32, 15.09, 15.33, 17.50, 18.84,
     * 29.66, 53.06, 84.34/
        DATA B2/
     *  0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.180,
     *  0.210, 0.230, 0.300, 0.350, 0.380, 0.429, 0.468, 0.503, 0.544,
     *  0.560, 0.610, 0.677, 0.736, 0.770, 0.800, 0.851, 0.875, 1.050,
     *  3.707, 5.970, 7.028/
        DATA CTM/
     * -1.,   -1.,   -1.,   -0.90, -0.80, -0.68, -0.53, -0.37, -0.19,
     * -0.02,  0.11,  0.21,  0.27,  0.30,  0.34,  0.40,  0.44,  0.48,
     *  0.50,  0.54,  0.57,  0.60,  0.61,  0.63,  0.65,  0.67,  0.72,
     *  0.75,  0.906, 0.913/
        DATA TE/
     *  0.0437, 0.116, 0.143, 0.167, 0.192, 0.214, 0.231, 0.249,
     *  2.68,  4.15,  5.13,  6.12,  8.11, 17*0.0/
        DATA BE/
     *  0.838,  1.284, 1.695, 1.575, 1.989, 2.172, 2.388, 1.908,
     *  16.75,  18.92,  22.87,  23.88,  30.97, 17*0.0/
        DATA NL/30/
        DATA NE/13/
        RETURN
        END


      FUNCTION FACTOR(M)
      F=1.0
      IF(M-2 < 0) THEN
      GOTO 1
      ELSE IF (M-2 == 0) THEN
      GOTO 2
      ELSE IF (M-2 > 0) THEN
      GOTO 2
      END IF

    1 FACTOR=F
      RETURN
    2 DO 3 K=1,M
      F=FLOAT(K)*F
    3 CONTINUE
      FACTOR=F
      RETURN
      END


      FUNCTION BINOM(N,J)
      BINOM=FACTOR(N)/(FACTOR(J)*FACTOR(N-J))
      RETURN
      END



      SUBROUTINE TC5
      COMMON/COEFA/A1(72),A2(72),A3(72),A4(72),A5(72),A6(72),A7(32)
      COMMON/COEFBC/B1(64),B2(64),C(24)
      DATA A1/
     * 2.7404E 00 , -9.6998E 00 ,  1.0400E 01 ,  2.3882E 00 ,
     *-7.5137E 00 ,  4.4096E 01 , -7.4379E 01 ,  4.6038E 01 ,
     * 7.5479E 00 , -3.9274E 01 ,  6.4835E 01 , -4.1609E 01 ,
     *-1.8369E 00 ,  8.6911E 00 , -1.3060E 01 ,  7.1880E 00 ,
     *-3.0853E 01 ,  1.0624E 02 , -1.2939E 02 ,  5.4339E 01 ,
     * 1.9465E 01 , -6.8102E 01 ,  9.6358E 01 , -5.6827E 01 ,
     *-3.4831E 00 ,  1.2341E 01 , -1.8592E 01 ,  1.2024E 01 ,
     * 1.8941E-01 , -6.7880E-01 ,  1.0665E 00 , -7.2910E-01 ,
     * 1.0258E-01 , -1.0542E 00 ,  1.1389E 01 , -1.6638E 01 ,
     *-4.9607E-01 ,  1.1800E 01 , -9.0857E 01 ,  1.6476E 02 ,
     * 1.5437E 00 , -3.3769E 01 ,  2.5192E 02 , -4.5071E 02 ,
     *-1.2021E 00 ,  2.5336E 01 , -1.8658E 02 ,  3.3254E 02 ,
     * 1.5789E-01 ,  2.9671E 00 , -5.5251E 00 ,  6.8925E 00 ,
     *-7.0218E 00 , -2.0534E 02 ,  5.6951E 02 , -8.9858E 02 ,
     * 1.3496E 02 ,  4.8722E 03 , -1.4674E 04 ,  2.3924E 04 ,
     *-8.2116E 02 , -3.2586E 04 ,  1.0098E 05 , -1.6553E 05 ,
     * 3.1531E-01 , -7.4981E 00 ,  4.3295E 01 , -7.6360E 01 ,
     *-6.5373E 00 ,  1.9307E 02 , -1.0181E 03 ,  1.7426E 03 /
      DATA A2/
     * 4.6864E 01 , -1.3030E 03 ,  6.7291E 03 , -1.1075E 04 ,
     *-9.5192E 01 ,  2.6373E 03 , -1.2857E 04 ,  2.0294E 04 ,
     *-1.7953E 01 ,  1.0972E 02 , -2.3954E 02 ,  2.2826E 02 ,
     * 9.1968E 01 , -5.1963E 02 ,  1.1266E 03 , -1.0740E 03 ,
     *-1.3270E 02 ,  7.4112E 02 , -1.6000E 03 ,  1.5249E 03 ,
     * 5.8598E 01 , -3.1874E 02 ,  6.7751E 02 , -6.4011E 02 ,
     * 4.2169E-01 ,  1.4705E 02 , -6.5335E 02 ,  9.1507E 02 ,
     *-3.5198E 00 , -2.6019E 02 ,  1.2250E 03 , -1.7481E 03 ,
     * 3.6373E 00 ,  1.5592E 02 , -7.5201E 02 ,  1.0796E 03 ,
     *-7.8041E-01 , -3.0563E 01 ,  1.4795E 02 , -2.1250E 02 ,
     *-3.8288E-01 ,  3.7587E 00 , -6.5144E 00 ,  6.7740E 00 ,
     * 1.0381E 02 , -2.7282E 02 ,  4.7759E 02 , -5.1222E 02 ,
     *-1.7882E 03 ,  4.3052E 03 , -7.9314E 03 ,  9.3471E 03 ,
     * 7.1475E 03 , -3.3395E 03 , -4.1392E 03 , -4.4364E 03 ,
     * 2.4991E-01 ,  3.2028E 01 , -1.1882E 02 ,  1.5099E 02 ,
     *-2.6994E 00 , -4.6045E 02 ,  1.8959E 03 , -2.5190E 03 ,
     * 1.6268E 01 ,  2.1384E 03 , -9.1262E 03 ,  1.2431E 04 ,
     *-2.9654E 01,-3.1823E 03, 1.3944E 04,-1.9342E 04/
      DATA A3/
     * 3.9025E 00 , -9.1126E 01 ,  3.2373E 02 , -4.0048E 02 ,
     *-2.0619E 01 ,  4.9170E 02 , -1.7155E 03 ,  2.1143E 03 ,
     * 3.3004E 01 , -7.6684E 02 ,  2.7003E 03 , -3.3525E 03 ,
     *-1.6367E 01 ,  3.7394E 02 , -1.3202E 03 ,  1.6423E 03 ,
     * 1.9402E 01 , -2.2446E 02 ,  7.4733E 02 , -9.3570E 02 ,
     *-4.4180E 01 ,  4.7194E 02 , -1.4856E 03 ,  1.8055E 03 ,
     * 3.1567E 01 , -3.0176E 02 ,  9.0763E 02 , -1.0773E 03 ,
     *-6.8648E 00 ,  6.0476E 01 , -1.7520E 02 ,  2.0381E 02 ,
     * 4.0693E-01 , -4.1404E 00 ,  1.4044E 01 , -1.7265E 01 ,
     *-3.6799E 00 ,  5.9610E 01 , -1.6269E 02 ,  1.8873E 02 ,
     * 1.4556E 01 , -1.7550E 02 ,  4.5839E 02 , -5.3390E 02 ,
     *-1.2621E 01 ,  1.4964E 02 , -3.8118E 02 ,  4.5141E 02 ,
     *-4.7554E-01 ,  2.2641E 00 , -1.2528E 01 ,  2.4647E 01 ,
     * 5.1620E 00 , -9.9236E 00 ,  5.5623E 01 , -1.0462E 02 ,
     *-8.1117E 00 ,  1.9315E 01 , -8.4255E 01 ,  1.3908E 02 ,
     * 3.5187E 00 , -9.1783E 00 ,  3.4950E 01 , -5.1243E 01 ,
     * 4.8173E-01 ,  5.7726E 00 , -1.3745E 01 ,  2.7125E 01 ,
     *-4.4804E 00 , -3.8582E 01 ,  1.1159E 02 , -2.4305E 02/
      DATA A4/
     * 1.6306E 01 ,  1.1046E 02 , -3.3045E 02 ,  7.2270E 02 ,
     *-1.5968E 01 , -8.0140E 01 ,  2.4616E 02 , -6.0753E 02 ,
     *-5.1646E 00 , -6.0776E 00 ,  7.8989E 01 , -1.0705E 02 ,
     * 2.1871E 01 ,  5.6915E 01 , -4.0159E 02 ,  5.1215E 02 ,
     *-2.7993E 01 , -9.4670E 01 ,  5.6928E 02 , -6.9621E 02 ,
     * 1.1587E 01 ,  4.5998E 01 , -2.456 E 02 ,  2.8452E 02 ,
     *-5.3067E 01 ,  5.7612E 02 , -1.5438E 03 ,  1.6455E 05 ,
     * 1.4750E 02 , -1.6 38E 03 ,  4.5923E 03 , -4.9949E 03 ,
     *-1.3436E 02 ,  1.5780E 03 , -4.4463E 03 ,  4.9022E 03 ,
     * 4.0253E 01 , -4.8860E 02 ,  1.4001E 03 , -1.5606E 03 ,
     * 1.4988E-01 ,  2.8753E 00 , -5.3078E 00 ,  6.2233E 00 ,
     *-5.9558E 00 , -1.6203E 02 ,  4.3079E 02 , -6.2548E 02 ,
     * 1.2875E 02 ,  3.1402E 03 , -7.9189E 03 ,  1.0983E 04 ,
     *-8.5161E 02 , -1.8780E 04 ,  4.4607E 04 , -5.8790E 04 ,
     * 5.3689E-01 , -1.3216E 01 ,  8.1011E 01 , -1.4285E 02 ,
     *-1.0550E 01 ,  2.9629E 02 , -1.6957E 03 ,  2.8935E 03 ,
     * 6.9621E 01 , -1.9245E 03 ,  1.0620E 04 , -1.7468E 04 ,
     *-1.3865E 02 ,  3.9281E 03 , -2.0293E 04 ,  3.2058E 04/
      DATA A5/
     * 6.5288E-01 ,  3.8977E-01 ,  8.4078E-01 ,  1.8893E-01 ,
     *-4.3964E 00 ,  3.4309E 01 , -7.3692E 01 ,  8.4308E 01 ,
     * 1.4889E 01 , -1.4380E 02 ,  3.1227E 02 , -3.5014E 02 ,
     *-1.5658E 01, 1.7160E 02,-3.7212E 02, 4.1299E 02,
     * 8.5591E-02 ,  5.0390E 00 , -1.3782E 01 ,  1.4661E 01 ,
     * 5.4284E-02 , -9.2324E 00 ,  3.6397E 01 , -4.2962E 01 ,
     *-5.1111E-02 ,  4.6003E 00 , -2.0534E 01 ,  2.7731E 01 ,
     * 7.4514E-03 , -6.2529E-01 ,  2.9159E 00 , -4.1101E 00 ,
     * 7.1622E-02 ,  3.0960E 00 , -1.1125E 01 ,  1.8130E 01 ,
     * 9.2581E-02 , -3.2186E 00 ,  2.0273E 01 , -3.3245E 01 ,
     *-5.1531E-02 ,  8.9886E-01 , -7.5084E 00 ,  1.3188E 01 ,
     * 5.8258E-03 , -1.7288E-03 ,  7.0224E-01 , -1.4854E 00 ,
     * 8.2300E-02 ,  1.5854E-01 ,  3.7716E 00 , -4.0562E 00 ,
     * 1.0802E-02 , -3.3688E-01 ,  1.1727E 00 , -6.7476E-01 ,
     *-2.1798E-03 ,  5.2166E-02 , -2.5816E-01 ,  3.2048E-01 ,
     * 6.5764E-05 , -1.4711E-03 ,  7.8209E-03 , -1.0580E-02 ,
     * 1.1138E-01 ,  6.0396E-01 ,  3.0174E 00 , -4.4190E 00 ,
     *-1.7709E-02 ,  2.3015E-01 , -1.8187E 00 ,  3.4518E 00/
      DATA A6/
     * 2.0977E-03 , -2.5458E-02 ,  2.1626E-01 , -4.0692E-01 ,
     *-5.4799E-05 ,  5.9111E-04 , -5.5552E-03 ,  1.0647E-02 ,
     * 1.7288E-01 ,  7.1080E 00 , -1.7961E 01 ,  1.6403E 01 ,
     *-1.4504E-01 , -1.3032E 01 ,  4.1781E 01 , -4.0799E 01 ,
     * 4.5390E-02 ,  8.3515E 00 , -3.0260E 01 ,  3.2882E 01 ,
     *-4.7961E-03 , -1.4095E 00 ,  5.3505E 00 , -6.0946E 00 ,
     * 3.7596E-02 ,  1.4331E 00 , -3.1350E 00 ,  6.4864E 00 ,
     * 2.3827E-01 ,  1.8253E 00 ,  1.7648E 00 , -1.6735E 01 ,
     *-1.5410E-01 , -1.5201E 00 , -1.5692E 00 ,  1.7185E 01 ,
     * 2.5037E-02 ,  3.0588E-01 ,  3.2520E-01 , -3.5277E 00 ,
     * 1.2489E-01 ,  1.3573E 00 ,  8.2338E-01 , -1.4595E 00 ,
     *-5.1577E-02 , -3.5778E-01 , -1.1690E 00 ,  1.8078E 00 ,
     * 7.4864E-03 ,  3.2888E-02 ,  2.3744E-01 , -3.9802E-01 ,
     *-2.9880E-04 , -7.5117E-04 , -1.1402E-02 ,  1.9505E-02 ,
     * 1.8470E-01 ,  1.9269E 00 , -3.2979E 00 ,  3.6843E 00 ,
     *-7.3932E-02 ,  2.7213E-01 ,  1.0600E 00 , -2.3354E 00 ,
     * 1.8907E-02 , -5.6473E-02 , -1.6487E-01 ,  3.8426E-01 ,
     *-9.2984E-04 ,  2.5506E-03 ,  7.3052E-03 , -1.7220E-02/
      DATA A7/
     *-1.0306E 00 ,  3.2849E 01 , -7.5052E 01 ,  6.0255E 01 ,
     * 7.9586E 00 , -1.2572E 02 ,  2.5604E 02 , -1.6547E 02 ,
     *-1.4797E 01 ,  1.6590E 02 , -2.7991E 02 ,  1.1333E 02 ,
     * 8.2309E 00 , -6.7871E 01 ,  8.5762E 01 ,  5.9727E 00 ,
     *-2.3722E 02 ,  9.6890E 02 , -1.6219E 03 ,  1.3637E 03 ,
     * 6.5800E 02 , -2.6941E 03 ,  4.5480E 03 , -3.8460E 03 ,
     *-6.0653E 02 ,  2.4983E 03 , -4.2498E 03 ,  3.6136E 03 ,
     * 1.8604E 02,-7.6933E 02, 1.3166E 03,-1.1242E 03/
      DATA B1/
     * 5.0278E-01 ,  3.1442E 00 , -7.8172E 00 ,  8.1667E 00 ,
     * 9.3482E-01 , -1.0590E 01 ,  2.9227E 01 , -3.4550E 01 ,
     *-9.6685E-02 ,  4.7335E 00 , -1.4298E 01 ,  1.7685E 01 ,
     *-2.5041E-02 , -6.2478E-01 ,  2.0282E 00 , -2.5895E 00 ,
     * 1.1965E 00 , -8.2889E-01 ,  1.0426E 00 , -1.9090E 00 ,
     * 2.8703E-01 , -4.9065E 00 ,  1.6264E 01 , -1.9904E 01 ,
     *-2.4492E-01 ,  2.9191E 00 , -9.5776E 00 ,  1.1938E 01 ,
     * 3.7297E-02 , -4.2200E-01 ,  1.3883E 00 , -1.7476E 00 ,
     * 1.3508E 00 , -4.3139E 00 ,  1.2291E 01 , -1.5288E 01 ,
     *-2.0086E-01 ,  1.3641E 00 , -3.4030E 00 ,  3.8559E 00 ,
     * 1.2583E-02 , -8.3492E-02 ,  1.8600E-01 , -2.0043E-01 ,
     *-2.3628E-04 ,  1.3514E-03 , -2.4324E-03 ,  2.1906E-03 ,
     * 1.2419E 00 , -4.3633E 00 ,  1.3743E 01 , -1.8592E 01 ,
     *-2.4404E-01 ,  1.3158E 00 , -3.5691E 00 ,  4.3867E 00 ,
     * 1.5693E-02 , -8.2579E-02 ,  2.1427E-01 , -2.5846E-01 ,
     *-2.9386E-04 ,  1.4060E-03 , -3.3835E-03 ,  3.8664E-03/
      DATA B2/
     * 6.3054E-01 , -3.7333E 00 ,  1.3464E 01 , -1.8594E 01 ,
     * 2.1801E 00 ,  1.5163E 00 , -1.6380E 01 ,  2.7944E 01 ,
     *-1.2886E 00 , -2.4570E 00 ,  1.5129E 01 , -2.3295E 01 ,
     * 2.0915E-01 ,  5.2279E-01 , -2.8687E 00 ,  4.2688E 00 ,
     * 9.3363E-01 , -1.8181E 00 ,  5.5157E 00 , -8.5216E 00 ,
     * 1.7811E 00 , -8.2927E 00 ,  2.0607E 01 , -2.0827E 01 ,
     *-1.5264E 00 ,  6.8433E 00 , -1.6067E 01 ,  1.6845E 01 ,
     * 2.7128E-01 , -1.1944E 00 ,  2.7495E 00 , -2.9045E 00 ,
     * 1.9439E 00 , -4.6268E 00 ,  9.7879E 00 , -9.6074E 00 ,
     *-3.4640E-01 ,  1.1093E 00 , -1.9313E 00 ,  1.7064E 00 ,
     * 2.7054E-02 , -1.1638E-01 ,  2.6969E-01 , -3.1853E-01 ,
     *-6.6092E-04 ,  5.0728E-03 , -1.4995E-02 ,  1.9605E-02 ,
     * 1.8693E 00 , -5.5678E 00 ,  1.4795E 01 , -1.6903E 01 ,
     *-4.9965E-01 ,  1.7874E 00 , -4.1330E 00 ,  3.8393E 00 ,
     * 4.6194E-02 , -1.8536E-01 ,  4.5315E-01 , -4.6273E-01 ,
     *-1.3341E-03, 5.7710E-03,-1.4554E-02, 1.5554E-02/
      DATA C/
     * 1.4509E-01 ,  4.6520E-01 , -3.3005E-02 ,  1.5376E-01 ,
     * 2.7436E-01 , -1.4604E-02 ,  6.2959E-01 ,  1.7866E-01 ,
     *-2.6216E-03 ,  8.3810E-01 ,  8.6137E-03 ,  3.2946E-03 ,
     * 9.2852E-02 ,  5.3886E-01 , -5.4493E-02 ,  1.3032E-01 ,
     * 4.0709E-01 , -2.8782E-02 ,  1.4909E-01 ,  3.8502E-01 ,
     *-1.2775E-02, 1.8024E-01, 3.3022E-01,-9.4491E-03/
         RETURN
         END

      

      SUBROUTINE CINEMA(PSTAR,V,P,CT,ST,CFI,SFI,T,CM)
C
C     KINEMATIC BLOCK. BACKWARD LORENTS TRANSFORMATION:
C
C     PSTAR ---> -V ---> P
C
C     N.B.: SPECIAL CASE V=0 SHOULD BE TREATED SEPARATELY !
C
      DIMENSION PSTAR(3),V(3),P(3)
      SPV = PSTAR(1)*V(1)+PSTAR(2)*V(2)+PSTAR(3)*V(3)
      V2 = V(1)**2+V(2)**2+V(3)**2
      TEMP1 = SQRT(1.-V2)
      TEMP2 = SPV*(1./TEMP1-1.)/V2
      PMSTAR = SQRT(PSTAR(1)**2+PSTAR(2)**2+PSTAR(3)**2)
      TSTAR=SQRT(PMSTAR**2+CM**2)-CM
      P(1) = PSTAR(1)+V(1)*TEMP2+V(1)*(TSTAR+CM)/TEMP1
      P(2) = PSTAR(2)+V(2)*TEMP2+V(2)*(TSTAR+CM)/TEMP1
      P(3) = PSTAR(3)+V(3)*TEMP2+V(3)*(TSTAR+CM)/TEMP1
      PM = SQRT(P(1)**2+P(2)**2+P(3)**2)
      IF (PM.GT.1.E-30) THEN
          CT = P(3)/PM
          TEMP4 = 1.-CT**2
          IF(TEMP4.GT.0.0) THEN
              ST = SQRT(TEMP4)
              TEMP3 = PM*ST  
              CFI=P(1)/TEMP3
              SFI=P(2)/TEMP3
          ELSE  ! FORWARD DIRECTION
              CT=1.
              CFI=1.
              SFI=0.
              ST=0.
          ENDIF
      ELSE    ! BECAUSE PM TOO LOW
          CT=1.
          CFI=1.
          SFI=0.
          ST=0.
      ENDIF
      T = SQRT(PM**2+CM**2)-CM
      RETURN
         END


      SUBROUTINE CMS(P,V,PSTART,T,CM)
      DIMENSION P(3),V(3),PSTART(3)
      V2=V(1)**2+V(2)**2+V(3)**2
      TEMP1=SQRT(1.-V2)
      SPV=P(1)*V(1)+P(2)*V(2)+P(3)*V(3)
      TEMP2=SPV/V2*(1./TEMP1-1.)
      SV=(T+CM)/TEMP1
      PSTART(1)=P(1)+V(1)*TEMP2+V(1)*SV
      PSTART(2)=P(2)+V(2)*TEMP2+V(2)*SV
      PSTART(3)=P(3)+V(3)*TEMP2+V(3)*SV
      RETURN
      END




      FUNCTION FINT1 (FNAME,FLIM1,FLIM2,BS,RS)
!
!  GAUSS QUADRATURE METHOD FOR FUNCTION FNAME IN
!  THE REGION [FLIM1,FLIM2]
!    
      COMMON/COHELP/W(8),FIKS(8)
      TEMP = 0.
      DO 30 IT=1,8
      FY = ((FLIM1-FLIM2)*FIKS(IT)+FLIM1+FLIM2)/2.
      TEMP = TEMP+W(IT)*FNAME(FY,BS,RS)
   30 CONTINUE
      FINT1 = TEMP*(FLIM1-FLIM2)/2.
      RETURN
         END





      FUNCTION PMOM (J,T)
C     BLOCK OF CALCULATION OF SECONDARY PARTICLES MOMENTUM.
      COMMON/COEFBC/BNKJ,CKJ
      DIMENSION BNKJ(4,4,8),CKJ(3,8),BNK(4,4)

      real vran(1)

      DO 10 K=1,4
      DO N=1,4
      BNK(N,K) = BNKJ(N,K,J)
      END DO
   10 CONTINUE
      S1 = 0.
      call ranmar(vran,1)
      R1 = vran(1)
      S2 = 0.
      S3 = 0.
      IF((T.GT.0.0).AND.(R1.GT.0.0)) THEN
         DO 11 N=1,4
         DO K=1,4
       S1 = S1+BNK(N,K)*(T**(K-1))*(R1**(N-1))
         END DO
   11    CONTINUE
      ELSE
       S1 = BNK(1,1)+BNK(2,1)*R1+BNK(3,1)*R1**2+BNK(4,1)*R1**3
      ENDIF
      IF(T.GT.0.0) THEN
         DO 12 N=1,4
         DO K=1,4
           S2 = S2+BNK(N,K)*T**(K-1)
         END DO
   12    CONTINUE
        DO 13 K=1,3
          S3 = S3+CKJ(K,J)*T**(K-1)
   13   CONTINUE
      ELSE
           S2 = BNK(1,1)+BNK(2,1)+BNK(3,1)+BNK(4,1)
           S3 = CKJ(1,J)
      ENDIF
      PMOM = S3*SQRT(R1)*(S1+(1.-S2)*R1**4)
      RETURN
         END



